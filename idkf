{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "15bf11c6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:38:51.793295Z",
     "iopub.status.busy": "2024-12-19T12:38:51.793022Z",
     "iopub.status.idle": "2024-12-19T12:39:01.735513Z",
     "shell.execute_reply": "2024-12-19T12:39:01.734435Z"
    },
    "executionInfo": {
     "elapsed": 8129,
     "status": "ok",
     "timestamp": 1721367100568,
     "user": {
      "displayName": "Kishan Adhikary",
      "userId": "06010834230959638485"
     },
     "user_tz": -345
    },
    "id": "hdTRX7E9GfsF",
    "outputId": "a0fe35a5-df22-4dd5-9776-cff750c8a761",
    "papermill": {
     "duration": 9.948014,
     "end_time": "2024-12-19T12:39:01.737437",
     "exception": false,
     "start_time": "2024-12-19T12:38:51.789423",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/hwt-v5\n",
      "Collecting gdown\r\n",
      "  Downloading gdown-5.2.0-py3-none-any.whl.metadata (5.8 kB)\r\n",
      "Requirement already satisfied: beautifulsoup4 in /opt/conda/lib/python3.10/site-packages (from gdown) (4.12.2)\r\n",
      "Requirement already satisfied: filelock in /opt/conda/lib/python3.10/site-packages (from gdown) (3.13.1)\r\n",
      "Requirement already satisfied: requests[socks] in /opt/conda/lib/python3.10/site-packages (from gdown) (2.32.3)\r\n",
      "Requirement already satisfied: tqdm in /opt/conda/lib/python3.10/site-packages (from gdown) (4.66.4)\r\n",
      "Requirement already satisfied: soupsieve>1.2 in /opt/conda/lib/python3.10/site-packages (from beautifulsoup4->gdown) (2.5)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown) (3.3.2)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown) (3.6)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown) (1.26.18)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown) (2024.7.4)\r\n",
      "Requirement already satisfied: PySocks!=1.5.7,>=1.5.6 in /opt/conda/lib/python3.10/site-packages (from requests[socks]->gdown) (1.7.1)\r\n",
      "Downloading gdown-5.2.0-py3-none-any.whl (18 kB)\r\n",
      "Installing collected packages: gdown\r\n",
      "Successfully installed gdown-5.2.0\r\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "%cd /kaggle/input/hwt-v5\n",
    "%pip install --upgrade --no-cache-dir gdown\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "37bb6a20",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:39:01.744390Z",
     "iopub.status.busy": "2024-12-19T12:39:01.744091Z",
     "iopub.status.idle": "2024-12-19T12:39:02.754303Z",
     "shell.execute_reply": "2024-12-19T12:39:02.753349Z"
    },
    "papermill": {
     "duration": 1.016012,
     "end_time": "2024-12-19T12:39:02.756450",
     "exception": false,
     "start_time": "2024-12-19T12:39:01.740438",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "!rm -rf /kaggle/working/*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "3e46daae",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:39:02.763902Z",
     "iopub.status.busy": "2024-12-19T12:39:02.763629Z",
     "iopub.status.idle": "2024-12-19T12:39:03.786330Z",
     "shell.execute_reply": "2024-12-19T12:39:03.785289Z"
    },
    "papermill": {
     "duration": 1.028978,
     "end_time": "2024-12-19T12:39:03.788391",
     "exception": false,
     "start_time": "2024-12-19T12:39:02.759413",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[0m\u001b[01;34mHandwriting-Transformers\u001b[0m/\r\n"
     ]
    }
   ],
   "source": [
    "%ls\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4ccc56bd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:39:03.795871Z",
     "iopub.status.busy": "2024-12-19T12:39:03.795301Z",
     "iopub.status.idle": "2024-12-19T12:39:03.801120Z",
     "shell.execute_reply": "2024-12-19T12:39:03.800218Z"
    },
    "papermill": {
     "duration": 0.011275,
     "end_time": "2024-12-19T12:39:03.802836",
     "exception": false,
     "start_time": "2024-12-19T12:39:03.791561",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/hwt-v5/Handwriting-Transformers\n"
     ]
    }
   ],
   "source": [
    "%cd Handwriting-Transformers"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "15997afc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:39:03.809261Z",
     "iopub.status.busy": "2024-12-19T12:39:03.808984Z",
     "iopub.status.idle": "2024-12-19T12:39:04.809469Z",
     "shell.execute_reply": "2024-12-19T12:39:04.808639Z"
    },
    "papermill": {
     "duration": 1.006045,
     "end_time": "2024-12-19T12:39:04.811615",
     "exception": false,
     "start_time": "2024-12-19T12:39:03.805570",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[0m\u001b[01;34mFigures\u001b[0m/    README.md   demo_custom_handwriting.ipynb  params.py  \u001b[01;34mutil\u001b[0m/\r\n",
      "INSTALL.md  \u001b[01;34mdata\u001b[0m/       \u001b[01;34mmodels\u001b[0m/                        \u001b[01;34mresults\u001b[0m/\r\n",
      "LICENSE     demo.ipynb  mytext.txt                     train.py\r\n"
     ]
    }
   ],
   "source": [
    "%ls"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "1f42ae5f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:39:04.819333Z",
     "iopub.status.busy": "2024-12-19T12:39:04.818714Z",
     "iopub.status.idle": "2024-12-19T12:39:05.824752Z",
     "shell.execute_reply": "2024-12-19T12:39:05.823960Z"
    },
    "papermill": {
     "duration": 1.011711,
     "end_time": "2024-12-19T12:39:05.826472",
     "exception": false,
     "start_time": "2024-12-19T12:39:04.814761",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[0m\u001b[01;34mFigures\u001b[0m/    README.md   demo_custom_handwriting.ipynb  params.py  \u001b[01;34mutil\u001b[0m/\r\n",
      "INSTALL.md  \u001b[01;34mdata\u001b[0m/       \u001b[01;34mmodels\u001b[0m/                        \u001b[01;34mresults\u001b[0m/\r\n",
      "LICENSE     demo.ipynb  mytext.txt                     train.py\r\n"
     ]
    }
   ],
   "source": [
    "%ls"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "93b021ff",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:39:05.833661Z",
     "iopub.status.busy": "2024-12-19T12:39:05.833395Z",
     "iopub.status.idle": "2024-12-19T12:39:08.131365Z",
     "shell.execute_reply": "2024-12-19T12:39:08.130511Z"
    },
    "papermill": {
     "duration": 2.304227,
     "end_time": "2024-12-19T12:39:08.133770",
     "exception": false,
     "start_time": "2024-12-19T12:39:05.829543",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[33mWARNING\u001b[0m Path /kaggle/input/hwt-v5/Handwriting-Transformers/wandb/ wasn't writable, using system temp directory\r\n",
      "W&B online. Running your script from this directory will now sync to the cloud.\r\n"
     ]
    }
   ],
   "source": [
    "!wandb online"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "eecd1c96",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:39:08.141403Z",
     "iopub.status.busy": "2024-12-19T12:39:08.141090Z",
     "iopub.status.idle": "2024-12-19T12:39:16.799087Z",
     "shell.execute_reply": "2024-12-19T12:39:16.798223Z"
    },
    "papermill": {
     "duration": 8.664458,
     "end_time": "2024-12-19T12:39:16.801370",
     "exception": false,
     "start_time": "2024-12-19T12:39:08.136912",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: wandb in /opt/conda/lib/python3.10/site-packages (0.17.4)\r\n",
      "Requirement already satisfied: click!=8.0.0,>=7.1 in /opt/conda/lib/python3.10/site-packages (from wandb) (8.1.7)\r\n",
      "Requirement already satisfied: docker-pycreds>=0.4.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (0.4.0)\r\n",
      "Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (3.1.41)\r\n",
      "Requirement already satisfied: platformdirs in /opt/conda/lib/python3.10/site-packages (from wandb) (3.11.0)\r\n",
      "Requirement already satisfied: protobuf!=4.21.0,<6,>=3.19.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (3.20.3)\r\n",
      "Requirement already satisfied: psutil>=5.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (5.9.3)\r\n",
      "Requirement already satisfied: pyyaml in /opt/conda/lib/python3.10/site-packages (from wandb) (6.0.1)\r\n",
      "Requirement already satisfied: requests<3,>=2.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (2.32.3)\r\n",
      "Requirement already satisfied: sentry-sdk>=1.0.0 in /opt/conda/lib/python3.10/site-packages (from wandb) (2.8.0)\r\n",
      "Requirement already satisfied: setproctitle in /opt/conda/lib/python3.10/site-packages (from wandb) (1.3.3)\r\n",
      "Requirement already satisfied: setuptools in /opt/conda/lib/python3.10/site-packages (from wandb) (69.0.3)\r\n",
      "Requirement already satisfied: six>=1.4.0 in /opt/conda/lib/python3.10/site-packages (from docker-pycreds>=0.4.0->wandb) (1.16.0)\r\n",
      "Requirement already satisfied: gitdb<5,>=4.0.1 in /opt/conda/lib/python3.10/site-packages (from gitpython!=3.1.29,>=1.0.0->wandb) (4.0.11)\r\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (3.3.2)\r\n",
      "Requirement already satisfied: idna<4,>=2.5 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (3.6)\r\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (1.26.18)\r\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /opt/conda/lib/python3.10/site-packages (from requests<3,>=2.0.0->wandb) (2024.7.4)\r\n",
      "Requirement already satisfied: smmap<6,>=3.0.1 in /opt/conda/lib/python3.10/site-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb) (5.0.1)\r\n"
     ]
    }
   ],
   "source": [
    "!pip install wandb"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "766a767b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-12-19T12:39:16.810070Z",
     "iopub.status.busy": "2024-12-19T12:39:16.809373Z",
     "iopub.status.idle": "2024-12-19T12:39:23.490196Z",
     "shell.execute_reply": "2024-12-19T12:39:23.489394Z"
    },
    "papermill": {
     "duration": 6.687355,
     "end_time": "2024-12-19T12:39:23.492317",
     "exception": false,
     "start_time": "2024-12-19T12:39:16.804962",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Traceback (most recent call last):\r\n",
      "  File \"/kaggle/input/hwt-v5/Handwriting-Transformers/train.py\", line 10, in <module>\r\n",
      "    from data.dataset import TextDataset, TextDatasetval\r\n",
      "  File \"/kaggle/input/hwt-v5/Handwriting-Transformers/data/dataset.py\", line 18, in <module>\r\n",
      "    from params import *\r\n",
      "  File \"/kaggle/input/hwt-v5/Handwriting-Transformers/params.py\", line 31\r\n",
      "    VOCAB_SIZE = len(ALPHABET)fu\r\n",
      "                              ^^\r\n",
      "SyntaxError: invalid syntax\r\n"
     ]
    }
   ],
   "source": [
    "!python train.py"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe3286bd",
   "metadata": {
    "papermill": {
     "duration": 0.003164,
     "end_time": "2024-12-19T12:39:23.499003",
     "exception": false,
     "start_time": "2024-12-19T12:39:23.495839",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "accelerator": "GPU",
  "colab": {
   "authorship_tag": "ABX9TyMyn2SUl55yTt0b4o10xA5A",
   "gpuType": "T4",
   "name": "",
   "version": ""
  },
  "kaggle": {
   "accelerator": "nvidiaTeslaT4",
   "dataSources": [
    {
     "datasetId": 5469803,
     "sourceId": 9068654,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5469976,
     "sourceId": 9068878,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5470017,
     "sourceId": 9068926,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5470110,
     "sourceId": 9069039,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5414776,
     "sourceId": 9091231,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5469670,
     "sourceId": 9091468,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 5499616,
     "sourceId": 9111817,
     "sourceType": "datasetVersion"
    },
    {
     "datasetId": 6336770,
     "sourceId": 10245974,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30747,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 34.441888,
   "end_time": "2024-12-19T12:39:23.719787",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-12-19T12:38:49.277899",
   "version": "2.5.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
